<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>購物車</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="./style/style購物.css" />
    <style>
      body {
        font-family: Arial, sans-serif;
        /* margin: 20px; */
        height: 130vh;
      }
      .cart-container {
        max-width: 900px;
        margin: auto;
        text-align: center;
        margin-top: 150px; 
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }
      th,
      td {
        border: 1px solid #555;
        padding: 10px;
        text-align: center;
      }
      .btn {
        background-color: #ff4d4d;
        color: white;
        border: none;
        cursor: pointer;
        padding: 8px;
      }
      .btn:hover {
        background-color: #cc0000;
      }
      .quantity-btn {
        cursor: pointer;
        padding: 5px 10px;
        border: 1px solid #ddd;
        background-color: #f8f8f8;
        margin: 2px;
      }
      .Checkout {
        /* border: 2px solid red; */
        display: flex;
        flex-direction: row; /* 讓元素縱向排列 */
        align-items: center; /* 水平置中 */
        justify-content: center; /* 垂直置中 */
        gap: 50px; /* 控制項目間距 */
        padding: 20px;
        /* background-color: #f8f8f8; */
        /* border-radius: 10px; */
        /* box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); */
        /* max-width: 300px;
        margin: 0 auto; 確保整個區塊在頁面上置中 */
      }
      #total-price {
        font-size: 18px;
        font-weight: bold;
      }
      .Button-Checkout {
        padding: 10px 20px;
        /* background-color: #28a745;
        color: white;*/
        /* border: none; */
        border-radius: 5px;
        /* cursor: pointer; */
      }
      .Button-Checkout:active {
        transform: scale(0.98); /* 按下時縮小，不用改變顏色 */
      }
    </style>
  </head>
  <body>
    <header>
      <nav>
        <ul>
          <section class="logo">
            <img src="./裝備照片jpg/person-swimming-solid.svg" alt="自由潛水" />
            <a href="../1.潛水網站/潛水網站最新.html" style="text-decoration: none;"><h1>自由潛水</h1></a>
          </section>
          <li class="dropdown-menu1">
            <a href="#"><i class="fa-solid fa-location-pin"></i> 潛水裝備</a>
            <ul class="dropdown-menu">
              <li><a href="./index.html">自潛蛙鞋</a></li>
              <li><a href="http://127.0.0.1:5501/3.%E8%A3%9D%E5%82%99%E8%B3%BC%E7%89%A9/%E8%B3%BC%E7%89%A9%E9%A6%96%E9%A0%81.html?tab=content_2">面鏡/呼吸管</a></li>
              <li><a href="http://127.0.0.1:5501/3.%E8%A3%9D%E5%82%99%E8%B3%BC%E7%89%A9/%E8%B3%BC%E7%89%A9%E9%A6%96%E9%A0%81.html?tab=content_3">防寒衣</a></li>
            </ul>
          </li>
          <li class="dropdown-menu2">
            <a href="#"
              ><i class="fa-solid fa-right-to-bracket"></i> 課程報名</a
            >
            <ul class="dropdown-menu">
              <li><a href="#">自潛課程</a></li>
              <li><a href="#">水肺課程</a></li>
              <li><a href="#">教練培訓課程</a></li>
            </ul>
          </li>
          <li class="dropdown-menu3">
            <a href="#"><i class="fa-solid fa-book"></i> 回訓專區</a>
            <ul class="dropdown-menu">
              <li><a href="#">潛水深度練習</a></li>
              <li><a href="#">自潛安全戒護</a></li>
              <li><a href="#">平靜水域練習</a></li>
            </ul>
          </li>
          <li class="dropdown-menu4">
            <a href="#"><i class="fa-regular fa-address-book"></i> 服務據點</a>
            <ul class="dropdown-menu">
              <li><a href="#">東北角</a></li>
              <li><a href="#">恆春</a></li>
              <li><a href="#">小琉球</a></li>
            </ul>
          </li>
          <li>
            <a href="#"><i class="fas fa-user"></i></a>
          </li>
          <li>
            <a href="#" onclick="toggleCart()">
              <i class="fas fa-shopping-cart"></i
            ></a>
          </li>
        </ul>
      </nav>
    </header>
    <div class="cart-container">
      <h2>購物車</h2>
      <table>
        <thead>
          <tr>
            <th>商品名稱</th>
            <th>尺寸</th>
            <th>顏色</th>
            <th>數量</th>
            <th>價錢</th>
            <th>總共</th>
            <th>操作</th>
          </tr>
        </thead>
        <tbody id="cart-items">
          <!-- 購物車內容將動態添加 -->
        </tbody>
      </table>
      <div class="Checkout">
        <h3 id="total-price">總金額：0 元</h3>
        <a href="../1.潛水網站/潛水網站最新.html" style="text-decoration: none;"><button class="Button-Checkout" onclick="showAlert()" >結帳</button></a>
      </div>
    </div>
    <footer>
      <section class="logo">
        <h3>
          <img src="./images/person-swimming-solid.svg" alt="logo" />自由潛水
        </h3>
      </section>
      <section class="links">
        <a href="#"><img src="./Icons/facebook.svg" alt="facebook" /></a>
        <a href="#"><img src="./Icons/instagram.svg" alt="instagram" /></a>
        <a href="#"><img src="./Icons/twitter.svg" alt="twitter" /></a>
        <a href="#"><img src="./Icons/youtube.svg" alt="youtube" /></a>
      </section>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const cartItemsContainer = document.getElementById("cart-items");
        const totalPriceContainer = document.getElementById("total-price");

        function renderCart() {
          cartItemsContainer.innerHTML = "";
          let totalPrice = 0;

          cart.forEach((item) => {
            totalPrice += item.total;
            const row = document.createElement("tr");
            row.innerHTML = `
              <td>${item.name}</td>
              <td>${item.size}</td>
              <td>${item.color}</td>
              <td>
                <button class="quantity-btn" onclick="updateQuantity('${item.pid}', -1)">−</button>
                ${item.quantity}
                <button class="quantity-btn" onclick="updateQuantity('${item.pid}', 1)">+</button>
              </td>
              <td>${item.price} 元</td>
              <td>${item.total} 元</td>
              <td><button class="btn" onclick="removeFromCart('${item.pid}')">移除</button></td>
            `;
            cartItemsContainer.appendChild(row);
          });

          totalPriceContainer.textContent = `總金額：${totalPrice} 元`;
          localStorage.setItem("cart", JSON.stringify(cart));
        }

        window.updateQuantity = function (pid, change) {
          let item = cart.find((item) => item.pid === pid);
          if (item) {
            item.quantity += change;
            if (item.quantity < 1) {
              item.quantity = 1; // 防止數量變成 0
            }
            item.total = item.quantity * item.price; // 確保價格計算正確
            renderCart();
          }
        };

        window.removeFromCart = function (pid) {
          cart = cart.filter((item) => item.pid !== pid);
          renderCart();
        };

        renderCart();
      });
      function showAlert() {
            alert("結帳完成");
        }
    </script>
  </body>
</html>
